{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/nova/apps/tracking/src/app/user/%5Bphone%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useParams } from 'next/navigation';\nimport Link from 'next/link';\nimport Lottie from 'lottie-react';\nimport redCarAnimation from '../../../../public/Red Car.json';\nimport greenTruckAnimation from '../../../../public/Green Trucks.json';\n\ninterface Contract {\n  _id: string;\n  lot_number: string;\n  signature_data: string;\n  timestamp: string;\n  ip_address?: string;\n}\n\ninterface UserDetails {\n  phone_number: string;\n  full_name: string;\n  address: string;\n  gatepass: string;\n  owner_name: string;\n  owner_phone: string;\n  contracts: Contract[];\n  contract_count: number;\n  first_contract: string;\n  last_contract: string;\n}\n\ninterface ApiResponse {\n  success: boolean;\n  user: UserDetails;\n  error?: string;\n}\n\nexport default function UserDetailPage() {\n  const params = useParams();\n  const phone = params.phone as string;\n  const [user, setUser] = useState<UserDetails | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (phone) {\n      fetchUserDetails();\n    }\n  }, [phone]);\n\n  const fetchUserDetails = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch(`/api/user/${encodeURIComponent(phone)}`);\n      const data: ApiResponse = await response.json();\n      \n      if (data.success) {\n        setUser(data.user);\n      } else {\n        setError(data.error || 'Error al cargar información del usuario');\n      }\n    } catch (err) {\n      setError('Error de conexión');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('es-ES', {\n      weekday: 'long',\n      day: 'numeric',\n      month: 'short', \n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    }).replace(/^\\w/, (c) => c.toUpperCase());\n  };\n\n  const formatPhoneForDisplay = (phoneNumber: string) => {\n    // Remove country code and format as (XXX) XXX-XXXX\n    const cleaned = phoneNumber.replace(/^\\+\\d+/, '');\n    if (cleaned.length === 10) {\n      return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(6)}`;\n    }\n    return phoneNumber;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-black mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Cargando información del usuario...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !user) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center\">\n            <svg className=\"w-8 h-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L5.082 15.5c-.77.833.192 2.5 1.732 2.5z\" />\n            </svg>\n          </div>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Usuario no encontrado</h3>\n          <p className=\"text-gray-500 mb-6\">{error || 'No se pudo cargar la información del usuario'}</p>\n          <Link\n            href=\"/users\"\n            className=\"px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors\"\n          >\n            Volver a Usuarios\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"w-full px-6 py-4\">\n        {/* Header */}\n        <div className=\"bg-black rounded-3xl shadow-lg mb-8 overflow-hidden text-white\">\n          <div className=\"px-12 py-8 text-center\">\n            <h1 className=\"text-4xl font-bold mb-3\">Jorge Minnesota Logistics LLC</h1>\n            <p className=\"text-gray-100 text-xl\">Información del Usuario</p>\n          </div>\n        </div>\n\n        {/* Navigation */}\n        <div className=\"mb-8 flex justify-start\">\n          <Link\n            href=\"/users\"\n            className=\"inline-flex items-center px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors\"\n          >\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\n            </svg>\n            Volver a Usuarios\n          </Link>\n        </div>\n\n        {/* User Information Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12\">\n          \n          {/* Usuario del Contrato */}\n          <div className=\"bg-white rounded-3xl p-8 border-l-4 border-black shadow-sm\">\n            <div className=\"flex items-center mb-6\">\n              <div className=\"w-2 h-8 bg-black rounded-full mr-4\"></div>\n              <h2 className=\"text-xl font-semibold text-gray-900\">Usuario</h2>\n            </div>\n            <div className=\"space-y-4\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Nombre</p>\n                <p className=\"text-lg text-gray-900\">{user.full_name}</p>\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Teléfono</p>\n                <p className=\"text-lg font-mono text-gray-900\">{formatPhoneForDisplay(user.phone_number)}</p>\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Dirección</p>\n                <p className=\"text-gray-900\">{user.address}</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Dueño de la Cuenta */}\n          <div className=\"bg-white rounded-3xl p-8 border-l-4 border-black shadow-sm\">\n            <div className=\"flex items-center mb-6\">\n              <div className=\"w-2 h-8 bg-black rounded-full mr-4\"></div>\n              <h2 className=\"text-xl font-semibold text-gray-900\">Propietario</h2>\n            </div>\n            <div className=\"space-y-4\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Nombre</p>\n                <p className=\"text-lg text-gray-900\">{user.owner_name || 'No especificado'}</p>\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Teléfono</p>\n                <p className=\"text-lg font-mono text-gray-900\">{user.owner_phone ? formatPhoneForDisplay(user.owner_phone) : 'No especificado'}</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Información Adicional */}\n          <div className=\"bg-white rounded-3xl p-8 border-l-4 border-green-500 shadow-sm\">\n            <div className=\"flex items-center mb-6\">\n              <div className=\"w-2 h-8 bg-green-500 rounded-full mr-4\"></div>\n              <h2 className=\"text-xl font-semibold text-gray-900\">Datos</h2>\n            </div>\n            <div className=\"space-y-4\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Gatepass</p>\n                <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-black text-white\">\n                  {user.gatepass}\n                </span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-500 mb-1\">Contratos</p>\n                  <p className=\"text-5xl font-bold text-green-600\">{user.contract_count}</p>\n                </div>\n                <div className=\"w-20 h-20 flex-shrink-0\">\n                  <Lottie \n                    animationData={greenTruckAnimation} \n                    loop={true} \n                    autoplay={true}\n                    style={{ width: '100%', height: '100%' }}\n                  />\n                </div>\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-1\">Primer contrato</p>\n                <p className=\"text-gray-900\">{formatDate(user.first_contract).split(',')[0]}</p>\n              </div>\n            </div>\n          </div>\n\n        </div>\n\n        {/* Contracts History - Modern List */}\n        <div className=\"space-y-3\">\n          <div className=\"bg-black text-white p-4 rounded-t-2xl\">\n            <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-4\">\n              <h2 className=\"text-xl font-bold\">Historial de Contratos</h2>\n              <span className=\"px-3 py-1 bg-white/20 rounded-lg text-sm font-medium\">\n                {user.contracts.length} contrato{user.contracts.length !== 1 ? 's' : ''}\n              </span>\n            </div>\n            \n            <div className=\"text-sm opacity-90\">\n              Mostrando todos los contratos del usuario\n            </div>\n          </div>\n\n          {user.contracts.length === 0 ? (\n            <div className=\"bg-white rounded-xl border border-gray-100 text-center py-16\">\n              <div className=\"max-w-md mx-auto\">\n                <div className=\"w-16 h-16 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center\">\n                  <svg className=\"w-8 h-8 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n                  </svg>\n                </div>\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No hay contratos registrados</h3>\n                <p className=\"text-gray-500 mb-6\">Los contratos aparecerán aquí cuando se registren en el sistema</p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"bg-white rounded-b-2xl shadow-sm overflow-hidden\">\n              <div className=\"divide-y divide-gray-100\">\n                {user.contracts.map((contract, index) => (\n                  <div key={contract._id}>\n                    <div className=\"hover:bg-gray-50 transition-colors\">\n                      <div className=\"grid grid-cols-12 gap-4 px-6 py-4 items-center\">\n                        <div className=\"col-span-1\">\n                          <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center\">\n                            <span className=\"text-sm font-semibold text-gray-900\">#{index + 1}</span>\n                          </div>\n                        </div>\n                        <div className=\"col-span-2 text-sm text-gray-900\">\n                          <span className=\"font-mono font-semibold\">{contract.lot_number}</span>\n                        </div>\n                        <div className=\"col-span-2 text-sm text-gray-600\">\n                          <span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-black text-white\">\n                            {user.gatepass}\n                          </span>\n                        </div>\n                        <div className=\"col-span-3 text-sm text-gray-600\">\n                          {formatDate(contract.timestamp)}\n                        </div>\n                        <div className=\"col-span-2 text-xs text-gray-500 font-mono\">\n                          {contract.ip_address && contract.ip_address !== '::1' ? contract.ip_address : 'Local'}\n                        </div>\n                        <div className=\"col-span-2 flex gap-2 items-center\">\n                          <Link\n                            href={`/viaje/${contract._id}`}\n                            target=\"_blank\"\n                            className=\"px-2 py-1 bg-black text-white text-xs font-medium rounded-lg hover:bg-gray-800 transition-colors\"\n                          >\n                            Ver Detalle\n                          </Link>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}