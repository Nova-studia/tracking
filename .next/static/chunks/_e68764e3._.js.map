{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///home/nova/apps/tracking/src/app/users/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport Lottie from 'lottie-react';\nimport redCarAnimation from '../../../public/Red Car.json';\nimport greenTruckAnimation from '../../../public/Green Trucks.json';\n\ninterface Contract {\n  _id: string;\n  lot_number: string;\n  signature_data: string;\n  timestamp: string;\n  ip_address?: string;\n}\n\ninterface User {\n  phone_number: string;\n  full_name: string;\n  address: string;\n  gatepass: string;\n  contracts: Contract[];\n  contract_count: number;\n  first_contract: string;\n  last_contract: string;\n}\n\ninterface ApiResponse {\n  success: boolean;\n  users: User[];\n  total: number;\n  error?: string;\n}\n\nexport default function UsersPage() {\n  const [users, setUsers] = useState<User[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n\n  const fetchUsers = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/users');\n      const data: ApiResponse = await response.json();\n      \n      if (data.success) {\n        setUsers(data.users);\n      } else {\n        setError(data.error || 'Error al cargar usuarios');\n      }\n    } catch (err) {\n      setError('Error de conexión');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('es-ES', {\n      weekday: 'long',\n      day: 'numeric',\n      month: 'short', \n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    }).replace(/^\\w/, (c) => c.toUpperCase());\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-900 p-4\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"text-center py-12\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-8 bg-gray-700 rounded w-48 mx-auto mb-4\"></div>\n              <div className=\"h-4 bg-gray-700 rounded w-32 mx-auto\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-900 p-4\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"text-center py-12\">\n            <div className=\"text-red-400 text-lg\">{error}</div>\n            <button\n              onClick={fetchUsers}\n              className=\"mt-4 px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors\"\n            >\n              Reintentar\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"w-full px-6 py-4\">\n        {/* Header */}\n        <div className=\"bg-black rounded-3xl shadow-lg mb-8 overflow-hidden text-white\">\n          <div className=\"px-12 py-8 text-center\">\n            <h1 className=\"text-4xl font-bold mb-3\">Jorge Minnesota Logistics LLC</h1>\n            <p className=\"text-gray-100 text-xl\">Registro de Usuarios del Sistema</p>\n          </div>\n        </div>\n\n        {/* Dashboard Statistics */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8\">\n          <div className=\"bg-white rounded-3xl p-8 border-l-4 border-black shadow-sm\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <div className=\"text-5xl font-bold text-black mb-2\">\n                  {users.filter(user => {\n                    const lastContractDate = new Date(user.last_contract);\n                    const today = new Date();\n                    return lastContractDate.toDateString() === today.toDateString();\n                  }).length}\n                </div>\n                <p className=\"text-gray-600 text-lg font-medium\">Usuarios Hoy</p>\n              </div>\n              <div className=\"w-40 h-40 flex-shrink-0\">\n                <Lottie \n                  animationData={redCarAnimation} \n                  loop={true} \n                  autoplay={true}\n                  style={{ width: '100%', height: '100%' }}\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-3xl p-8 border-l-4 border-black shadow-sm\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <div className=\"text-5xl font-bold text-black mb-2\">\n                  {users.filter(user => {\n                    const lastContractDate = new Date(user.last_contract);\n                    const today = new Date();\n                    const weekStart = new Date(today);\n                    weekStart.setDate(today.getDate() - today.getDay());\n                    return lastContractDate >= weekStart && lastContractDate <= today;\n                  }).length}\n                </div>\n                <p className=\"text-gray-600 text-lg font-medium\">Esta Semana</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-3xl p-8 border-l-4 border-green-500 shadow-sm\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <div className=\"text-5xl font-bold text-green-600 mb-2\">{users.length}</div>\n                <p className=\"text-gray-600 text-lg font-medium\">Total Usuarios</p>\n              </div>\n              <div className=\"w-40 h-40 flex-shrink-0\">\n                <Lottie \n                  animationData={greenTruckAnimation} \n                  loop={true} \n                  autoplay={true}\n                  style={{ width: '100%', height: '100%' }}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"space-y-3\">\n        {/* Lista de Usuarios Section */}\n        <div className=\"bg-black text-white p-4 rounded-t-2xl\">\n          <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-4\">\n            <h2 className=\"text-xl font-bold\">Lista de Usuarios</h2>\n            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-2\">\n              <Link\n                href=\"/admin\"\n                className=\"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-sm font-medium flex items-center gap-2\"\n              >\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                </svg>\n                Admin\n              </Link>\n              <button className=\"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-sm font-medium\">\n                Actualizar\n              </button>\n            </div>\n          </div>\n          \n          <div className=\"text-sm opacity-90\">\n            Mostrando {users.length} usuarios registrados\n          </div>\n        </div>\n\n        {loading ? (\n          <div className=\"bg-white rounded-xl border border-gray-100 text-center py-16\">\n            <div className=\"animate-spin rounded-full h-8 w-8 sm:h-12 sm:w-12 border-b-2 border-black mx-auto mb-4\"></div>\n            <span className=\"text-sm sm:text-base text-gray-500\">Cargando usuarios...</span>\n          </div>\n        ) : users.length === 0 ? (\n          <div className=\"bg-white rounded-xl border border-gray-100 text-center py-16\">\n            <div className=\"max-w-md mx-auto\">\n              <div className=\"w-16 h-16 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-8 h-8 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\"/>\n                </svg>\n              </div>\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No hay usuarios registrados</h3>\n              <p className=\"text-gray-500 mb-6\">Los usuarios aparecerán aquí cuando se registren contratos en el sistema</p>\n            </div>\n          </div>\n        ) : (\n          <div className=\"bg-white rounded-b-2xl shadow-sm overflow-hidden\">\n            {/* Table Headers */}\n            <div className=\"bg-white border-b border-gray-200\">\n              <div className=\"grid grid-cols-12 gap-4 px-6 py-4 text-sm font-semibold text-gray-700\">\n                <div className=\"col-span-1\"></div>\n                <div className=\"col-span-2\">Teléfono</div>\n                <div className=\"col-span-2\">Nombre</div>\n                <div className=\"col-span-2\">Dirección</div>\n                <div className=\"col-span-3\">Último Contrato</div>\n                <div className=\"col-span-2\">Contratos</div>\n              </div>\n            </div>\n            \n            {/* Table Rows */}\n            <div className=\"divide-y divide-gray-100\">\n              {users.map((user, index) => (\n                <div key={user.phone_number}>\n                  <div className=\"hover:bg-gray-50 transition-colors\">\n                    <div className=\"grid grid-cols-12 gap-4 px-6 py-4 items-center\">\n                      <div className=\"col-span-1\">\n                        <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center\">\n                          <svg className=\"w-4 h-4 text-black\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                          </svg>\n                        </div>\n                      </div>\n                      <div className=\"col-span-2 text-sm text-gray-900\">\n                        {user.phone_number}\n                      </div>\n                      <div className=\"col-span-2 text-sm text-gray-900\">\n                        {user.full_name || 'N/A'}\n                      </div>\n                      <div className=\"col-span-2\">\n                        <span className=\"text-sm text-gray-600\">\n                          {user.address || 'N/A'}\n                        </span>\n                      </div>\n                      <div className=\"col-span-3 text-sm text-gray-600\">\n                        {formatDate(user.last_contract)}\n                      </div>\n                      <div className=\"col-span-2 flex gap-2 items-center justify-start\">\n                        <span className=\"px-3 py-1 bg-black text-white text-sm rounded font-medium min-w-[100px] text-center\">\n                          {user.contract_count} contrato{user.contract_count !== 1 ? 's' : ''}\n                        </span>\n                        <Link\n                          href={`/user/${encodeURIComponent(user.phone_number)}`}\n                          target=\"_blank\"\n                          className=\"px-3 py-1 bg-white text-black border border-black text-sm font-medium rounded hover:bg-gray-100 transition-colors min-w-[60px] text-center\"\n                        >\n                          Info\n                        </Link>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}