(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3792:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(5155),o=r(2115);function n(){let[e,t]=(0,o.useState)("+1"),[r,n]=(0,o.useState)(""),[a,l]=(0,o.useState)(""),[i,c]=(0,o.useState)(""),[d,m]=(0,o.useState)(""),[u,x]=(0,o.useState)(""),[h,g]=(0,o.useState)(!1),[b,p]=(0,o.useState)(null),[f,v]=(0,o.useState)(!1),[y,N]=(0,o.useState)(!1),[j,w]=(0,o.useState)(!1),[C,E]=(0,o.useState)(""),[S,D]=(0,o.useState)(""),[k,L]=(0,o.useState)(!1),[A,T]=(0,o.useState)(null),[M,O]=(0,o.useState)(""),[P,R]=(0,o.useState)(""),H=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=H.current;if(!e)return;let t=e.getContext("2d");t&&(t.lineWidth=3,t.lineCap="round",t.lineJoin="round",t.strokeStyle="#000000",t.fillStyle="#ffffff",t.fillRect(0,0,e.width,e.height));let r=e=>{e.preventDefault()};return e.addEventListener("touchstart",r,{passive:!1}),e.addEventListener("touchmove",r,{passive:!1}),e.addEventListener("touchend",r,{passive:!1}),()=>{e.removeEventListener("touchstart",r),e.removeEventListener("touchmove",r),e.removeEventListener("touchend",r)}},[]);let F=(e,t)=>{let r=t.getBoundingClientRect(),s=t.width/r.width,o=t.height/r.height;return{x:(e.clientX-r.left)*s,y:(e.clientY-r.top)*o}},z=(e,t)=>{let r=H.current;if(!r)return;let s=r.getContext("2d");s&&(v(!0),N(!0),s.beginPath(),s.moveTo(e,t))},I=(e,t)=>{if(!f)return;let r=H.current;if(!r)return;let s=r.getContext("2d");s&&(s.lineTo(e,t),s.stroke())},U=()=>{v(!1)},V=()=>{U()},q=()=>{let e=H.current;if(!e)return;let t=e.getContext("2d");t&&(t.clearRect(0,0,e.width,e.height),N(!1))},_=()=>{let t=r.replace(/\D/g,"");return"".concat(e).concat(t)},B=async()=>{let e=r.replace(/\D/g,"");if(!e||10!==e.length){E("Por favor, ingrese un n\xfamero de tel\xe9fono v\xe1lido de 10 d\xedgitos."),D("error");return}E(""),D(""),w(!0);try{let e=_(),t=await fetch("/api/check-phone/".concat(encodeURIComponent(e)));if(!t.ok)throw Error("Error en la respuesta del servidor");let r=await t.json();console.log("Phone check response:",r),r.exists&&r.userData?(p(r.userData),g(!0),r.userData.gatepass&&m(r.userData.gatepass),E("Tel\xe9fono verificado - Cliente existente. Proceda con el n\xfamero de lote."),D("success"),console.log("✅ Existing user verified:",r.userData)):(p(null),g(!0),E("Tel\xe9fono nuevo - Complete nombre, direcci\xf3n y n\xfamero de lote."),D("success"),console.log("✅ New user verified"))}catch(e){console.error("Phone verification error:",e),E("Error al verificar el tel\xe9fono. Intente nuevamente."),D("error"),g(!1)}finally{w(!1)}},W=async e=>{if(e.preventDefault(),console.log("Form submission - phoneVerified:",h,"userData:",b),!h){var t;E('Paso faltante: Debe hacer clic en "Verificar" junto al n\xfamero de tel\xe9fono antes de continuar.'),D("error"),null==(t=document.getElementById("phoneNumber"))||t.scrollIntoView({behavior:"smooth"});return}if(!u||8!==u.length){E("Por favor, ingrese un n\xfamero de lote v\xe1lido de 8 d\xedgitos."),D("error");return}if("error"===P){E("Este n\xfamero de lote ya ha sido registrado. Por favor, use otro n\xfamero."),D("error");return}if(!d.trim()){E("Por favor, ingrese el n\xfamero de Gatepass."),D("error");return}if(!b&&(!a.trim()||!i.trim())){E("Por favor, complete todos los campos requeridos."),D("error");return}if(!y){E("Por favor, firme el contrato antes de continuar."),D("error");return}w(!0);try{let e=H.current;if(!e)throw Error("Canvas no disponible");let t=e.toDataURL(),r={phoneNumber:_(),lotNumber:u.toUpperCase(),fullName:b?b.full_name:a,address:b?b.address:i,gatepass:d,signatureData:t};console.log("\uD83D\uDCE4 Sending contract data:",r);let s=await fetch("/api/contracts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(s.ok){let e=await s.json();T({contractId:e.contractId,lotNumber:u.toUpperCase(),fullName:b?b.full_name:a}),L(!0),w(!1)}else{let e=await s.json().catch(()=>({error:"Error desconocido"}));console.log("❌ Server error response:",e),E(e.error||"Error en el servidor"),D("error")}}catch(e){E("Error al procesar el contrato. Por favor, intente nuevamente."),D("error")}finally{w(!1)}},J=async e=>{if(8===e.length)try{let t=await fetch("/api/check-lot/".concat(encodeURIComponent(e)));(await t.json()).available?(O("✓ N\xfamero de lote disponible"),R("success")):(O("✗ Este n\xfamero de lote ya ha sido registrado"),R("error"))}catch(e){O(""),R("")}},Y=new Date().toLocaleDateString("es-ES"),Z=b?b.full_name:a||"[NOMBRE COMPLETO]",G=u||"[N\xdaMERO DE LOTE]";return(0,s.jsxs)("div",{className:"min-h-screen bg-black flex items-center justify-center p-3 sm:p-4",style:{touchAction:"manipulation"},children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-2xl w-full p-4 sm:p-6 lg:p-8 mx-3 sm:mx-4",style:{maxWidth:"100vw",boxSizing:"border-box"},children:[(0,s.jsxs)("div",{className:"text-center mb-4 sm:mb-6 lg:mb-8",children:[(0,s.jsx)("h1",{className:"text-lg sm:text-xl lg:text-2xl xl:text-3xl font-bold text-gray-800 mb-2 leading-tight px-2",children:"Contrato de Levantamiento de Veh\xedculo"}),(0,s.jsx)("div",{className:"text-base sm:text-lg lg:text-xl font-semibold text-red-600 mb-2 px-2",children:"Jorge Minnesota Logistics LLC"})]}),(0,s.jsxs)("form",{onSubmit:W,children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 mb-2",children:"N\xfamero de Tel\xe9fono:"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsxs)("select",{value:e,onChange:e=>t(e.target.value),disabled:h,className:"w-full sm:w-auto px-3 py-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100 bg-white text-base font-medium",style:{minHeight:"48px",fontSize:"16px"},children:[(0,s.jsx)("option",{value:"+1",children:"\uD83C\uDDFA\uD83C\uDDF8 +1 (EE.UU.)"}),(0,s.jsx)("option",{value:"+52",children:"\uD83C\uDDF2\uD83C\uDDFD +52 (M\xe9xico)"})]}),(0,s.jsx)("input",{type:"tel",id:"phoneNumber",value:r,onChange:e=>{let t=(e=>{let t=e.replace(/\D/g,"");return t.length>=6?"(".concat(t.slice(0,3),") ").concat(t.slice(3,6),"-").concat(t.slice(6,10)):t.length>=3?"(".concat(t.slice(0,3),") ").concat(t.slice(3)):t})(e.target.value);t.replace(/\D/g,"").length<=10&&n(t)},disabled:h,className:"flex-1 px-4 py-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100 text-base font-medium",placeholder:"(555) 123-4567",maxLength:14,style:{minHeight:"48px",fontSize:"16px"},required:!0}),(0,s.jsx)("button",{type:"button",onClick:B,disabled:h||j||10!==r.replace(/\D/g,"").length,className:"w-full sm:w-auto px-4 sm:px-6 py-4 text-white rounded-lg transition-colors text-base font-semibold ".concat(h?"bg-green-600 hover:bg-green-700":10!==r.replace(/\D/g,"").length?"bg-green-400 cursor-not-allowed":j?"bg-green-500":"bg-green-500 hover:bg-green-500"),style:{minHeight:"48px",fontSize:"16px",touchAction:"manipulation"},children:j?"Verificando...":h?"Verificado ✓":"Verificar"})]}),r&&(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 mt-2 break-all",children:["N\xfamero completo: ",(0,s.jsx)("span",{className:"font-mono",children:_()})]})]}),h&&!b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre y Apellido:"}),(0,s.jsx)("input",{type:"text",id:"fullName",value:a,onChange:e=>l(e.target.value),className:"w-full px-4 py-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-base font-medium",placeholder:"Ingrese su nombre completo",style:{minHeight:"48px",fontSize:"16px"},required:!0})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Direcci\xf3n:"}),(0,s.jsx)("input",{type:"text",id:"address",value:i,onChange:e=>c(e.target.value),className:"w-full px-4 py-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-base font-medium",placeholder:"Ingrese su direcci\xf3n completa",style:{minHeight:"48px",fontSize:"16px"},required:!0})]})]}),h&&(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{htmlFor:"lotNumber",className:"block text-sm font-medium text-gray-700 mb-2",children:"N\xfamero de Lote (8 d\xedgitos):"}),(0,s.jsx)("input",{type:"text",id:"lotNumber",value:u,onChange:e=>{let t=e.target.value.toUpperCase();x(t),8===t.length?J(t):(O(""),R(""))},maxLength:8,className:"w-full px-4 py-4 border-2 rounded-lg focus:ring-2 focus:ring-red-500 text-base font-mono font-medium ".concat("error"===P?"border-red-500 focus:border-red-500":"success"===P?"border-green-500 focus:border-green-500":"border-gray-300 focus:border-red-500"),placeholder:"Ejemplo: ABC12345",style:{minHeight:"48px",fontSize:"16px"},required:!0}),M&&(0,s.jsx)("p",{className:"text-xs sm:text-sm mt-2 ".concat("success"===P?"text-green-600":"text-red-600"),children:M})]}),h&&(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{htmlFor:"gatepass",className:"block text-sm font-medium text-gray-700 mb-2",children:"Gatepass (m\xe1ximo 6 caracteres):"}),(0,s.jsx)("input",{type:"text",id:"gatepass",value:d,onChange:e=>{let t=e.target.value.toUpperCase();/^[A-Z0-9]*$/.test(t)&&t.length<=6&&m(t)},maxLength:6,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-base font-mono font-medium",placeholder:"Ejemplo: ABC123",style:{minHeight:"48px",fontSize:"16px"},required:!0}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Solo letras y n\xfameros, m\xe1ximo 6 caracteres (",d.length,"/6)"]})]}),h&&(0,s.jsxs)("div",{className:"mb-6 sm:mb-8 p-4 sm:p-6 bg-gray-50 rounded-lg border-l-4 border-red-600",style:{lineHeight:"1.6"},children:[(0,s.jsx)("p",{className:"font-semibold text-base sm:text-lg mb-3 sm:mb-4",children:"CONTRATO DE AUTORIZACI\xd3N DE LEVANTAMIENTO"}),(0,s.jsxs)("p",{className:"mb-3 sm:mb-4 leading-relaxed text-sm sm:text-base",style:{fontSize:"15px",lineHeight:"1.5"},children:["Yo, ",(0,s.jsx)("span",{className:"font-semibold text-red-600",children:Z}),", el abajo firmante,",(0,s.jsx)("strong",{children:" ACEPTO Y RECONOZCO"})," que el veh\xedculo correspondiente al lote n\xfamero"," ",(0,s.jsx)("span",{className:"font-mono font-bold text-red-600 break-all",children:G})," es de mi propiedad y que entiendo que al t\xe9rmino de 3 meses el veh\xedculo se subastar\xe1 en caso de no ser pagado o retirado de las instalaciones de Jorge Minnesota Logistics LLC."]}),(0,s.jsx)("p",{className:"mb-3 sm:mb-4 leading-relaxed text-sm sm:text-base",children:"Esta declaraci\xf3n es otorgada de manera voluntaria y con pleno conocimiento de las consecuencias de esta acci\xf3n."}),(0,s.jsxs)("p",{className:"mb-3 sm:mb-4 text-sm sm:text-base",children:["Fecha: ",(0,s.jsx)("span",{className:"font-semibold",children:Y})]}),(0,s.jsx)("p",{className:"font-bold text-red-600 text-sm sm:text-base",children:"Jorge Minnesota Logistics LLC"})]}),h&&(0,s.jsxs)("div",{className:"mb-6 sm:mb-8 p-4 sm:p-6 border-2 border-dashed border-red-300 rounded-lg bg-gray-50",children:[(0,s.jsxs)("div",{className:"text-center mb-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Firma Digital:"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Dibuje su firma en el \xe1rea de abajo"})]}),(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("canvas",{ref:H,width:600,height:200,className:"border-2 border-gray-400 rounded-lg cursor-crosshair bg-white touch-none w-full max-w-full",style:{width:"100%",maxWidth:"600px",height:"auto",minHeight:"200px",touchAction:"none",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onMouseDown:e=>{let t=H.current;if(!t)return;let{x:r,y:s}=F(e.nativeEvent,t);z(r,s)},onMouseMove:e=>{let t=H.current;if(!t)return;let{x:r,y:s}=F(e.nativeEvent,t);I(r,s)},onMouseUp:V,onMouseLeave:V,onTouchStart:e=>{e.preventDefault();let t=H.current;if(!t||!e.touches[0])return;let{x:r,y:s}=F(e.touches[0],t);z(r,s)},onTouchMove:e=>{e.preventDefault();let t=H.current;if(!t||!e.touches[0])return;let{x:r,y:s}=F(e.touches[0],t);I(r,s)},onTouchEnd:e=>{e.preventDefault(),U()}})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("button",{type:"button",onClick:q,className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-base font-semibold",style:{minHeight:"48px",fontSize:"16px",touchAction:"manipulation"},children:"Limpiar Firma"}),y&&(0,s.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"Firma capturada ✓"})]})]}),h&&(0,s.jsx)("button",{type:"submit",disabled:j,className:"w-full py-4 bg-red-600 text-white text-lg font-bold rounded-lg hover:bg-red-700 disabled:bg-gray-400 transition-colors",style:{minHeight:"56px",fontSize:"18px",touchAction:"manipulation"},children:j?"Procesando...":"ACEPTAR Y FIRMAR CONTRATO"}),C&&(0,s.jsx)("div",{className:"mt-4 sm:mt-6 p-3 sm:p-4 rounded-lg text-center text-sm sm:text-base ".concat("success"===S?"bg-green-100 text-green-800 border border-green-300":"bg-red-100 text-red-800 border border-red-300"),children:C})]})]}),k&&A&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-md w-full mx-4 p-6 sm:p-8 text-center",children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("div",{className:"mx-auto w-12 h-12 sm:w-16 sm:h-16 bg-green-100 rounded-full flex items-center justify-center mb-3 sm:mb-4",children:(0,s.jsx)("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-2",children:"\xa1Registro Exitoso!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-3 sm:mb-4 text-sm sm:text-base",children:"El contrato ha sido firmado y guardado correctamente."})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6 text-left",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13h10M7 13l-1.5 6m9.5-6v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"})}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 break-all",children:[(0,s.jsx)("strong",{children:"Cliente:"})," ",A.fullName]})]}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 break-all",children:[(0,s.jsx)("strong",{children:"Lote:"})," ",A.lotNumber]})]}),(0,s.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 mb-3 sm:mb-4",children:"Su veh\xedculo ha sido verificado exitosamente."}),(0,s.jsx)("button",{onClick:()=>{t("+1"),n(""),l(""),c(""),m(""),x(""),g(!1),p(null),L(!1),T(null),E(""),D(""),O(""),R(""),q()},className:"w-full py-4 bg-black text-white font-bold rounded-lg hover:bg-red-700 transition-colors text-base",style:{minHeight:"48px",fontSize:"16px",touchAction:"manipulation"},children:"Registrar Otro Veh\xedculo"}),(0,s.jsx)("button",{onClick:()=>L(!1),className:"w-full py-4 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition-colors text-base",style:{minHeight:"48px",fontSize:"16px",touchAction:"manipulation"},children:"Cerrar"})]})]})})]})}},7208:(e,t,r)=>{Promise.resolve().then(r.bind(r,3792))}},e=>{e.O(0,[441,964,358],()=>e(e.s=7208)),_N_E=e.O()}]);